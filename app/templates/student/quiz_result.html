{% extends "student/layout.html" %}

{% block title %}{{ concept.name }} ì±„ì  ê²°ê³¼{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2 class="mb-4 text-center text-primary"><i class="fas fa-check-circle me-2"></i>{{ concept.name }} ì±„ì  ê²°ê³¼</h2>

  <div class="row justify-content-center mb-4">
    <div class="col-md-6">
      <div class="card text-center shadow">
        <div class="card-body">
          <h5 class="card-title">ì´ {{ total }}ë¬¸ì œ ì¤‘</h5>
          <h2 class="text-success">{{ correct }}ê°œ ì •ë‹µ ğŸ‰</h2>
          <p class="text-muted">ì •í™•í•œ ì‹¤ë ¥ì„ ìŒ“ì•„ê°€ê³  ìˆì–´ìš”!</p>
        </div>
      </div>
    </div>
  </div>

  {% for item in results %}
    <div class="card mb-4 shadow-sm">
      <div class="card-header d-flex justify-content-between align-items-center">
        <strong>ë¬¸ì œ {{ loop.index }}</strong>
        {% if item.is_correct %}
          <span class="badge bg-success">ì •ë‹µ</span>
        {% else %}
          <span class="badge bg-danger">ì˜¤ë‹µ</span>
        {% endif %}
      </div>
      <div class="card-body">
        <p>{{ item.question.content }}</p>
        {% if item.question.image_filename %}
          <img src="{{ url_for('static', filename='images/questions/' ~ item.question.image_filename) }}"
               class="img-fluid rounded mb-3 border" alt="ë¬¸ì œ ì´ë¯¸ì§€">
        {% endif %}

        {% set options = [item.question.option1, item.question.option2, item.question.option3, item.question.option4] %}
        <ul class="list-group">
          {% for opt in options %}
            {% set index = loop.index %}
            <li class="list-group-item d-flex justify-content-between align-items-center
                {% if item.user_answer == index|string %}list-group-item-warning{% endif %}
                {% if item.question.answer == index|string %}list-group-item-success fw-bold{% endif %}">
              {{ ['â‘ ','â‘¡','â‘¢','â‘£'][loop.index0] }} {{ opt }}
              {% if item.question.answer == index|string %}
                <span class="badge bg-success">ì •ë‹µ</span>
              {% elif item.user_answer == index|string %}
                <span class="badge bg-warning text-dark">ì„ íƒ</span>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  {% endfor %}

  <div class="text-center mt-4">
    <a href="{{ url_for('student.dashboard') }}" class="btn btn-outline-primary">ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</a>
    <a href="{{ url_for('student.my_mistake_notebook') }}" class="btn btn-outline-warning">ì˜¤ë‹µë…¸íŠ¸ ë³´ê¸°</a>
  </div>
</div>
{% endblock %}
