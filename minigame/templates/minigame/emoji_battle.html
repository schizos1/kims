{% extends "base.html" %}
{% load static %}
{% block title %}ì´ëª¨ì§€ ë°°í‹€{% endblock %}
{% block content %}
<div id="battle-area" style="width:800px; height:600px; margin:auto; position:relative; text-align:center;">
    <!-- ë°°ê²½(ë‚´ ì„ íƒë§Œ) -->
    <img id="bg-img" src="" style="position:absolute; left:0; top:0; width:800px; height:600px; z-index:0; display:none; object-fit:cover;">
    <!-- ê²Œì„ ìº”ë²„ìŠ¤ -->
    <canvas id="emoji-canvas" width="800" height="600" style="position:relative; z-index:1;"></canvas>
    <!-- ìºë¦­í„°/ë°°ê²½ ì„ íƒ UI -->
    <div id="emoji-select" style="position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); z-index:3; background:rgba(30,30,32,0.97); border-radius:16px; padding:32px 0 18px 0; width:560px; box-shadow:0 4px 32px #0002;">
        <div style="margin-bottom:10px; color:#eee; font-size:1.4rem;">ìºë¦­í„°ë¥¼ ì„ íƒí•˜ì„¸ìš”:</div>
        <div style="margin-bottom:8px;">
            <span class="emoji-btn" data-emoji="ğŸ§‘â€ğŸ¤">ğŸ§‘â€ğŸ¤</span>
            <span class="emoji-btn" data-emoji="ğŸ‘©â€ğŸš€">ğŸ‘©â€ğŸš€</span>
            <span class="emoji-btn" data-emoji="ğŸ‘¨â€ğŸ’»">ğŸ‘¨â€ğŸ’»</span>
            <span class="emoji-btn" data-emoji="ğŸ•µï¸">ğŸ•µï¸</span>
            <span class="emoji-btn" data-emoji="ğŸ‘¸">ğŸ‘¸</span>
            <span class="emoji-btn" data-emoji="ğŸ¦¸">ğŸ¦¸</span>
            <span class="emoji-btn" data-emoji="ğŸ§™â€â™‚ï¸">ğŸ§™â€â™‚ï¸</span>
            <span class="emoji-btn" data-emoji="ğŸ±">ğŸ±</span>
            <span class="emoji-btn" data-emoji="ğŸ¨">ğŸ¨</span>
            <span class="emoji-btn" data-emoji="ğŸ’">ğŸ’</span>
            <span class="emoji-btn" data-emoji="ğŸ¶">ğŸ¶</span>
            <span class="emoji-btn" data-emoji="ğŸ¦Š">ğŸ¦Š</span>
            <span class="emoji-btn" data-emoji="ğŸ¦„">ğŸ¦„</span>
            <span class="emoji-btn" data-emoji="ğŸ¸">ğŸ¸</span>
        </div>
        <div id="bg-select" style="margin:16px 0 8px 0;">
            <div style="margin-bottom:6px; color:#eee;">ë°°ê²½ì„ ì„ íƒí•˜ì„¸ìš”:</div>
            <span class="bg-btn" data-bg="bg_pastel.png"><img src="{% static 'minigame/emoji_battle/img/bg_pastel.png' %}" class="bg-thumb"></span>
            <span class="bg-btn" data-bg="ocean.png"><img src="{% static 'minigame/emoji_battle/img/ocean.png' %}" class="bg-thumb"></span>
            <span class="bg-btn" data-bg="bg_island.png"><img src="{% static 'minigame/emoji_battle/img/bg_island.png' %}" class="bg-thumb"></span>
        </div>
        <div style="margin-top:10px;">
            <button id="emoji-start-btn" class="btn btn-warning" style="font-size:1.15rem; padding:5px 36px;" disabled>ê²Œì„ ì‹œì‘</button>
        </div>
    </div>
    <!-- ê²°ê³¼ íŒì—…(ì´ë¯¸ì§€/í…ìŠ¤íŠ¸) -->
    <div id="game-result-popup" style="position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); background:rgba(28,28,30,0.94); color:#fff; font-size:2.4rem; padding:38px 60px 30px 60px; border-radius:26px; box-shadow:0 4px 24px #2228; z-index:99; display:none; text-align:center;">
        <img id="result-img" src="" style="width:170px; margin-bottom:16px; display:none;"><br>
        <span id="result-text"></span>
    </div>
    <div id="emoji-msg" style="position:absolute; left:0; bottom:8px; width:100%; z-index:2; color:#ffe958; font-size:1.22rem; letter-spacing:0.01em; text-shadow:1.2px 1.2px 3px #0008;"></div>
    <style>
        .emoji-btn { font-size: 2.3rem; margin: 0.1em 0.22em; cursor: pointer;
            border-radius: 0.3em; border: 2.5px solid transparent;
            transition: border 0.18s; display: inline-block; user-select: none;}
        .emoji-btn.selected { border: 2.5px solid #ffcc00; background: #232323; }
        .bg-thumb { width:70px; height:52px; border-radius:9px; border:2px solid #2222; margin:0 0.5em; object-fit:cover; }
        .bg-btn.selected .bg-thumb { border:2.5px solid #20e0ef; }
        .bg-btn { cursor:pointer; display:inline-block; }
        #emoji-select.hidden { display: none; }
        #game-result-popup { animation: popupfade .5s; }
        @keyframes popupfade { from{ opacity:0; } to{ opacity:1; } }
    </style>
</div>
{% endblock %}
{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pixi.js@7.x/dist/pixi.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/howler"></script>
<script src="https://cdn.jsdelivr.net/npm/socket.io-client@4.7.5/dist/socket.io.min.js"></script>
<script src="{% static 'js/games/emoji_battle/main.js' %}"></script>
{% endblock %}
